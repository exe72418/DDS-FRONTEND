import { isPlatformServer } from '@angular/common';
import { ɵDEFAULT_STATE_KEY } from '@ngxs/storage-plugin/internals';
export function storageOptionsFactory(options) {
    return {
        storage: 0 /* StorageOption.LocalStorage */,
        serialize: JSON.stringify,
        deserialize: JSON.parse,
        beforeSerialize: obj => obj,
        afterDeserialize: obj => obj,
        ...options,
        keys: options.keys === '*' ? [ɵDEFAULT_STATE_KEY] : options.keys
    };
}
export function engineFactory(options, platformId) {
    if (isPlatformServer(platformId)) {
        return null;
    }
    if (options.storage === 0 /* StorageOption.LocalStorage */) {
        return localStorage;
    }
    else if (options.storage === 1 /* StorageOption.SessionStorage */) {
        return sessionStorage;
    }
    return null;
}
export function getStorageKey(key, options) {
    // Prepends the `namespace` option to any key if it's been provided by a user.
    // So `@@STATE` becomes `my-app:@@STATE`.
    return options?.namespace ? `${options.namespace}:${key}` : key;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJuYWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcGFja2FnZXMvc3RvcmFnZS1wbHVnaW4vc3JjL2ludGVybmFscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNuRCxPQUFPLEVBQ0wsa0JBQWtCLEVBS25CLE1BQU0sZ0NBQWdDLENBQUM7QUFFeEMsTUFBTSxVQUFVLHFCQUFxQixDQUNuQyxPQUFpQztJQUVqQyxPQUFPO1FBQ0wsT0FBTyxvQ0FBNEI7UUFDbkMsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTO1FBQ3pCLFdBQVcsRUFBRSxJQUFJLENBQUMsS0FBSztRQUN2QixlQUFlLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHO1FBQzNCLGdCQUFnQixFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRztRQUM1QixHQUFHLE9BQU87UUFDVixJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUk7S0FDakUsQ0FBQztBQUNKLENBQUM7QUFFRCxNQUFNLFVBQVUsYUFBYSxDQUMzQixPQUFpQyxFQUNqQyxVQUFrQjtJQUVsQixJQUFJLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFDakMsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRUQsSUFBSSxPQUFPLENBQUMsT0FBTyx1Q0FBK0IsRUFBRSxDQUFDO1FBQ25ELE9BQU8sWUFBWSxDQUFDO0lBQ3RCLENBQUM7U0FBTSxJQUFJLE9BQU8sQ0FBQyxPQUFPLHlDQUFpQyxFQUFFLENBQUM7UUFDNUQsT0FBTyxjQUFjLENBQUM7SUFDeEIsQ0FBQztJQUVELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVELE1BQU0sVUFBVSxhQUFhLENBQUMsR0FBVyxFQUFFLE9BQWtDO0lBQzNFLDhFQUE4RTtJQUM5RSx5Q0FBeUM7SUFDekMsT0FBTyxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxTQUFTLElBQUksR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUNsRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNQbGF0Zm9ybVNlcnZlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuICDJtURFRkFVTFRfU1RBVEVfS0VZLFxuICBTdG9yYWdlT3B0aW9uLFxuICBTdG9yYWdlRW5naW5lLFxuICBOZ3hzU3RvcmFnZVBsdWdpbk9wdGlvbnMsXG4gIMm1Tmd4c1RyYW5zZm9ybWVkU3RvcmFnZVBsdWdpbk9wdGlvbnNcbn0gZnJvbSAnQG5neHMvc3RvcmFnZS1wbHVnaW4vaW50ZXJuYWxzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHN0b3JhZ2VPcHRpb25zRmFjdG9yeShcbiAgb3B0aW9uczogTmd4c1N0b3JhZ2VQbHVnaW5PcHRpb25zXG4pOiDJtU5neHNUcmFuc2Zvcm1lZFN0b3JhZ2VQbHVnaW5PcHRpb25zIHtcbiAgcmV0dXJuIHtcbiAgICBzdG9yYWdlOiBTdG9yYWdlT3B0aW9uLkxvY2FsU3RvcmFnZSxcbiAgICBzZXJpYWxpemU6IEpTT04uc3RyaW5naWZ5LFxuICAgIGRlc2VyaWFsaXplOiBKU09OLnBhcnNlLFxuICAgIGJlZm9yZVNlcmlhbGl6ZTogb2JqID0+IG9iaixcbiAgICBhZnRlckRlc2VyaWFsaXplOiBvYmogPT4gb2JqLFxuICAgIC4uLm9wdGlvbnMsXG4gICAga2V5czogb3B0aW9ucy5rZXlzID09PSAnKicgPyBbybVERUZBVUxUX1NUQVRFX0tFWV0gOiBvcHRpb25zLmtleXNcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVuZ2luZUZhY3RvcnkoXG4gIG9wdGlvbnM6IE5neHNTdG9yYWdlUGx1Z2luT3B0aW9ucyxcbiAgcGxhdGZvcm1JZDogc3RyaW5nXG4pOiBTdG9yYWdlRW5naW5lIHwgbnVsbCB7XG4gIGlmIChpc1BsYXRmb3JtU2VydmVyKHBsYXRmb3JtSWQpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAob3B0aW9ucy5zdG9yYWdlID09PSBTdG9yYWdlT3B0aW9uLkxvY2FsU3RvcmFnZSkge1xuICAgIHJldHVybiBsb2NhbFN0b3JhZ2U7XG4gIH0gZWxzZSBpZiAob3B0aW9ucy5zdG9yYWdlID09PSBTdG9yYWdlT3B0aW9uLlNlc3Npb25TdG9yYWdlKSB7XG4gICAgcmV0dXJuIHNlc3Npb25TdG9yYWdlO1xuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdG9yYWdlS2V5KGtleTogc3RyaW5nLCBvcHRpb25zPzogTmd4c1N0b3JhZ2VQbHVnaW5PcHRpb25zKTogc3RyaW5nIHtcbiAgLy8gUHJlcGVuZHMgdGhlIGBuYW1lc3BhY2VgIG9wdGlvbiB0byBhbnkga2V5IGlmIGl0J3MgYmVlbiBwcm92aWRlZCBieSBhIHVzZXIuXG4gIC8vIFNvIGBAQFNUQVRFYCBiZWNvbWVzIGBteS1hcHA6QEBTVEFURWAuXG4gIHJldHVybiBvcHRpb25zPy5uYW1lc3BhY2UgPyBgJHtvcHRpb25zLm5hbWVzcGFjZX06JHtrZXl9YCA6IGtleTtcbn1cbiJdfQ==